ExtensionDropdown=function(e){var t=$(e.body),n=e.getElementById("items"),i=e.getElementById("searchResults"),o=e.getElementById("recentSites"),a=e.getElementById("identitiesMenuItem"),r=e.getElementById("matchingSitesTopLevel"),s=e.getElementById("matchingSites"),l=e.getElementById("addCustomItems"),c=$("#panelContainer"),p=$("#topLevelContainer"),d=$("#vaultMenuItem"),u=$("#addOmariaItems"),m=$("#allItems"),g=$("#groupLabel"),f=$("#backButton"),b=$("#debugconsole"),v=$("#encryptedExportMenuItem"),h=$("#wifiExportMenuItem"),P=$("#matchingSitesMenuItem"),I=$("#recentSitesMenuItem"),y=$("#container"),L=$("#searchInput"),E=$("#applicationsMenuItem"),S=$("#logoContainer"),_=$("#logoPartner"),x=null,C=!1,T=null,w=null,k=null,M=null,D=function(){LPPlatform.setDropdownPopoverSize(y.outerHeight(),y.outerWidth())},A=function(e){LPPlatform.setDropdownPopoverSize(y.outerHeight(),e.outerWidth()+y.outerWidth())},O=null,F=null,B=null,N=null,R=null,z=null,H=null,V=null,G=null,K=null,W=null,U=null,Y=!1,j=!1,Z=!1,X=!1,q={},Q=null,J={},ee=[],te={},ne=function(e){if(g.empty(),e){var t=e.getName(),n=(t=t.replace(/\\/g," \\ ")).indexOf("\\",t.length/2);if(-1===n&&(n=t.lastIndexOf("\\")),n>0){var i=LPTools.createElement("div","textOverflowContainer groupLabel");i.appendChild(LPTools.createElement("span",null,t.substring(0,n))),g.append(LPTools.createElement("span","textTail","Â "+t.substring(n))),g.append(i),LPTools.setupMiddleEllipsis(g)}else g.append(LPTools.createElement("span","groupLabel",t));g.find(".groupLabel").attr("title",e.toString())}},ie,oe;te.GroupState=function(e){var t=LPTools.getNavIndex();this.pop=function(n){e.rebuildItems(null,n),n&&LPTools.setNavIndex(t),ne(e._model)}},te.SearchState=function(){var e=new te.CSSState("searchItem",{restoreKeyboardNav:!1});this.pop=function(){Ee(),e.pop()}},te.TopLevelMatchingSitesState=function(e){var t=new te.CSSState("matchingSites"),n=new te.GroupState(e);this.pop=function(){n.pop(),t.pop()}},te.CSSState=(ie=t.attr("class"),oe=function(e){t.removeClass(ie),t.addClass(e),ie=e},function(e,t){var n=ie;if(oe(e),LPTools.getOption(t,"applyKeyboardNav",!0)){var i=LPTools.getOption(t,"selectFirst",!1);LPTools.addKeyBoardNavigation($(".extensionMenuItem:visible"),{selectFirst:i})}this.pop=function(){ne(null),oe(n),LPTools.getOption(t,"restoreKeyboardNav",!0)&&LPTools.addKeyBoardNavigation($(".extensionMenuItem:visible"),{displayItems:0===ee.length&&U?U.getItems():null}),t&&"function"==typeof t.onPop&&t.onPop()}});var ae=function(){LPTools.parseUserSpecificMenu(e.getElementById("mainMenu"),LPProxy.getAccountClass()),LPProxy.isEnterpriseUser()&&$("#specialOfferMenuItem").hide(),$("#username").text(bg.get("g_username"))},re=function(){$("#container").LP_show(),ce();var e=bg.get("LPContentScriptFeatures").ziggy,t=bg.get("LPContentScriptFeatures").omaria;ExtensionLicenseExpiration.initialize(),M=LPProxy.getAccountClass(),T=bg.get("g_premium_trial_exp_days"),w=bg.get("g_company_trial_exp_days"),k=bg.get("g_company_license_exp_days"),x={isZiggySet:e,isOmarSet:t,showHelpText:e};var n=function(){se(),ve(),ye(x),ae(e),setTimeout(function(){pe()}),Ge(),e||($("#mainMenu").addClass("showIcons"),le()),bg.sendLpImprove("openicondropdown")},i=LPPlatform.getExtensionDropdownDelay();i>=0?setTimeout(n,i):n()},se=function(){y.addClass("loading")},le=function(){ExtensionLicenseExpiration.expiredCompanyStatusCheckerForPanelSize()?A(c):ExtensionLicenseExpiration.expiredPremiumStatusCheckerForPanelSize()?A(c):D(),y.addClass("initialized"),LPTools.addKeyBoardNavigation($(".extensionMenuItem:visible"),{displayItems:U?U.getItems():null}),L.focus()},ce=function(){LPFeatures.updateFeatures({import:!0,noexport:!1,show_notes:!0,hideidentities:!1,show_formfills:!0})},pe=function(){if(LPProxy.initializeModel(),he(x),ue(x),!j&&bg.get("g_local_accts_version")>-1){for(var e in j=!0,y.removeClass("loading"),J)J[e]();var t=L.val();t&&Se(t)}},de=function(e,t){var t=t||{};return LPProxy.getPreference("showAcctsInGroups",!0)&&(e=LPProxy.assignItemsToGroups(e,!1),t.separateFavorites=!0),new Container(e,t)},ue=function(e){e.isOmarSet?((B=new Container(LPProxy.getAllItems(),$.extend({},e,{omarItems:!0,trackAction:!0}))).setElement(n),K=new Container(LPProxy.getCustomNoteTemplates().map(function(e){return new AddCustomItemDisplay(e)}),$.extend({},e,{additionalItemClasses:"addOmariaItem",autoExpandSingleItem:!1,value:"Custom"})),fe(K.getItemCount())):((N=de(LPProxy.getSites(),e)).setElement(n),(R=de(LPProxy.getNotes(),e)).setElement(n),(z=new Container(LPProxy.getFormFills(),e)).setElement(n),(H=new Container(LPProxy.getApplications(),e)).setElement(n)),ExtensionLicenseExpiration.premiumTrialExpiringStatusChecker()?ExtensionLicenseExpiration.showExpiration(M,"trial",T):ExtensionLicenseExpiration.premiumTrialExpiredStatusChecker()?ExtensionLicenseExpiration.showExpiration(M,"trial",T):ExtensionLicenseExpiration.companyTrialExpiringStatusChecker()?ExtensionLicenseExpiration.showExpiration(M,"trial",w):ExtensionLicenseExpiration.companyTrialExpiredStatusChecker()?ExtensionLicenseExpiration.showExpiration(M,"trial",w):ExtensionLicenseExpiration.companyLicenseExpiredStatusChecker()&&ExtensionLicenseExpiration.showExpiration(M,"normal",k),G=new Container(LPProxy.getAllItems(),$.extend({},e,{moreOptionsState:te.SearchState,moreOptionsCallback:C?D:null}))},me=function(e){var t=["extensionMenuItem","omariaMenuItem"];e&&e.attrs&&e.attrs.class&&(t=t.concat(e.attrs.class));var n=$.extend({},e.attrs,{class:t}),i=LPTools.createElement("li",n);return i.appendChild(LPTools.createElement("i",e.icon+" menuIcon")),i.appendChild(LPTools.createElement("span","name",e.name)),e.addMoreButton&&i.appendChild(LPTools.createElement("div","more")),n.childView&&$(i).bind("click",Ke),e.onClick&&$(i).bind("click",e.onClick),i},ge=function(e,t){switch(t&&B.applyFilter({showEmptyGroups:!1,func:function(e){return e instanceof GroupDisplay||e.getRecordType()===t}}),B.rebuildItems(n,!e.originalEvent.isTrusted),t){case"Account":He(B,"Empty_Site_Omaria",Strings.translateString("You can save and fill usernames and passwords for any website or app."),Strings.translateString("Add a password"),t);break;case"Generic":He(B,"Empty_Note_Omaria",Strings.translateString("Use a secure note to save important documents in your LastPass vault."),Strings.translateString("Add a secure note"),t);break;case"Address":He(B,"Empty_Address_Omaria",Strings.translateString("Add an address to auto-fill your email, phone number, and other contact info."),Strings.translateString("Add an address"),t);break;case"Credit Card":He(B,"Empty_Credit_Card_Omaria",Strings.translateString("Next time you go shopping, they'll be waiting!"),Strings.translateString("Add a payment card"),t);break;case"Bank Account":He(B,"Empty_Bank_Account_Omaria",Strings.translateString("Save and fill your bank accounts securely on any device with LastPass."),Strings.translateString("Add a bank account"),t)}},fe=function(e){var t=LPProxy.getRecordConfig(),n=LPProxy.getAllModelTypes();u.empty(),m.empty(),t.viewConfig.forEach(function(i){if(i.forEach(function(i){if("all"!==i){var o=LPProxy.getConfigViewObject(i);o.types.forEach(function(i){if("cloud-apps"!==i&&"CloudApps"!==i){var a=LPProxy.getConfigTypeObject(i);(o.default||n.includes(a.recordType))&&m.append(me({attrs:{class:"omariaItem",childView:"omariaItems"},name:o.name,icon:t.icons[a.id],addMoreButton:!0,onClick:function(e){ge(e,a.recordType)}}));var r=null;a.recordType===t.TYPE.Custom?e>0&&(r=me({attrs:{class:"addOmariaItem",childView:"addCustomItems"},name:a.name,icon:t.icons[a.id],addMoreButton:!0,onClick:function(e){K.rebuildItems(l,!e.originalEvent.isTrusted)}})):r=me({attrs:{class:"addOmariaItem"},name:a.name,icon:t.icons[a.id],onClick:function(){be(a.recordType)}}),r&&u.append(r)}})}}),i!==t.viewConfig[0]){if(!m[0].lastChild.classList.contains("omarSpacer")){var o=LPTools.createElement("li","omarSpacer");m.append(o)}var a=LPTools.createElement("li","omarSpacer");u.children().last().hasClass("omarSpacer")||u.append(a)}});var i=LPTools.createElement("li",{class:"extensionMenuItem addOmariaItem",value:"saveAll"},Strings.translateString("Save All Entered Data"));u.append(i),$('.addOmariaItem[value="saveAll"]').bind("click",function(){bg.lpevent("m_saed"),bg.get_selected_tab_data(null,function(e){bg.sendLpImprove("save_all_entered_data",{domain:bg.lp_gettld_url(e.url)})}),bg.saveall()})},be=function(e){bg.lpevent("m_add"),"Account"===e?bg.get_selected_tab_data_no_extension(null,function(e){$e({defaultData:{url:e?e.url:""}})}):Me({defaultData:{notetype:e}})},ve=function(){b.LP_removeAttr("style"),v.LP_removeAttr("style"),h.LP_removeAttr("style"),E.LP_removeAttr("style"),bg.is_user_debug_enabled()&&b.show(),bg.have_binary()&&(v.show(),bg.LPPlatform.isWin()&&h.show()),LPTools.hasProperties(bg.get("g_applications"))&&E.show(),LPFeatures.allowNotes()?$("#notesMenuItem").show():$("#notesMenuItem").hide()},he=function(t){if(t.isOmarSet&&(a=e.getElementById("omarIdentitiesMenuItem")),F=LPProxy.getIdentities(),LPProxy.enableCurrentIdentity(F),F.length>0){xe(O);for(var n=[],i=0,o=F.length;i<o;++i)n.push(F[i].newDisplayObject());var r;new IdentityContainer(n,t).initialize(e.getElementById("identities"))}else $(a).hide()},Pe=function(e){return!0===q[e]},Ie=function(e,t,n){var i=function(e){var t=bg.lpmdec(e.extra,!0),n=/Language:(.+)/.exec(t);return n&&n.length>1?n[1].substr(0,2):"en"},o=[],a=[],r,s;for(r=0,s=Q.length;r<s;++r){var l=LPProxy.getNoteModel(Q[r].aid);if(l){var c=i(l._data);-1===a.indexOf(c)&&a.push(c)}}for(r=0,s=Q.length;r<s;++r){var p=Q[r].aid;if("account"===Q[r].type)o.push(new MatchingAccountDisplay(LPProxy.getSiteModel(p)));else if("note"===Q[r].type){var d=LPProxy.getNoteModel(p);o.push(new MatchingNoteDisplay(d,a.length>1?i(d._data):null))}}(U=new Container(o,t)).setElement(e),U.rebuildItems()},ye=function(t){for(var n=0,i=(Q=bg.getmatchingsites(!1,!0,!1)).length;n<i;++n)q[Q[n].aid]=!0;var o;t.isZiggySet||LPProxy.getPreference("toplevelmatchingsites",!1)?(I.addClass("divider"),d.addClass("divider"),p.removeClass("hidden"),Q.length>2?d.addClass("topLevelMatchesShadow"):(d.removeClass("topLevelMatchesShadow"),0===Q.length&&(d.removeClass("divider"),p.addClass("hidden"))),Ce("topLevelMatchingSites",function(){Ie(r,$.extend({},t,{autoExpandSingleItem:!1,moreOptionsElement:e.getElementById("matchingSites"),moreOptionsState:te.TopLevelMatchingSitesState,addLastClass:!1,trackAction:!0,sortFunction:VaultItemBaseDisplay.prototype.sortOmarMatchingItems}),!0),le()})()):(0===Q.length?P.LP_removeAttr("style"):(P.show(),$("#matchingSiteCounter").text(Q.length)),d.removeClass("divider"),d.removeClass("topLevelMatchesShadow"),p.addClass("hidden"))},Le=function(){var e=bg.getClearRecentTime(),t=bg.Preferences.get("recentUsedCount"),n=null;(n=bg.get("LPContentScriptFeatures").omaria?B.getItemChildren():N.getItemChildren().concat(R.getItemChildren())).sort(VaultItemBaseDisplay.prototype.sortByMostRecent);for(var i=[],a=0,r=n.length;a<r&&a<t;++a){var s=n[a];s.getLastTouchValue()>=e&&i.push(s._model.newDisplayObject())}i.length>0?(W=new Container(i,$.extend({},x,{sortFunction:VaultItemBaseDisplay.prototype.sortByMostRecent}))).initialize(o):Ae(o)},Ee=function(){LPTools.removeDOMChildren(i);for(var e=0,t=V.length;e<t;++e){var n=V[e],o=n.build(x);n.postBuild(o),i.appendChild(o)}if(0===V.length){var a=LPTools.buildEmptyPlaceholder(Strings.translateString("No Matching Results"),"extensionSearchPlaceholder",i);i.appendChild(a)}LPTools.addKeyBoardNavigation(i.children,{rightArrowSelector:".moreItem",selectFirst:!0,displayItems:V})},Se=(_e=null,function(e){e.length>0?(j&&(V&&V.forEach(function(e){e.hideInContextOptions()}),V=G.getSearchResultItems(e),Ee()),Y||(Oe("search",{applyKeyboardNav:!1,onPop:function(){L.val("")}}),Y=!0,bg.sendLpImprove("search",{source:"icon"}))):_e&&_e.length>0&&(Fe(),Y=!1),_e=e,C&&D()}),_e,xe=function(t){var n=Strings.translateString("Identities")+" ("+t.getName()+")",i=a.firstChild;3!==i.nodeType?(i=e.createTextNode(n),a.insertBefore(i,a.firstChild)):i.textContent=n},Ce=function(e,t){return function(){var n=this,i=arguments,o=function(){t.apply(n,i)};j?o():J[e]=o}},Te=function(e){e&&(e.stopPropagation(),e.preventDefault())},we=function(e){for(var t=null;null!==e&&null===(t=e.getAttribute("childview"));)e=e.parentElement;return t},ke=function(e){return e||(e={}),e.saveOptions={source:"icon"},e},$e=function(e){bg.LPPlatform.openTabDialog("site",ke(e))},Me=function(e){bg.LPPlatform.openTabDialog("note",ke(e))},De=function(e){bg.LPPlatform.openTabDialog("formFill",ke(e))},Ae=function(e){e.appendChild(LPTools.createElement("li","extensionMenuItem none","None Available"))},Oe=function(e,t){ee.push(new te.CSSState(e,t)),C&&D()},Fe=function(e){var t=ee.pop();t&&t.pop(e),C&&D()},Be=dialogs.generatePassword,Ne=function(){Be.getDialog().close(),f.unbind("click",Ne)},Re=null,ze=function(){!0===bg.get("LPContentScriptFeatures").better_generate_password_enabled&&(Be=dialogs.betterGeneratePassword),Be.open({preSetup:function(e){if(null===Re){var t=Be.parentElementID,n=e.options.hideHeader,i=e.dynamicHeight;Re=function(){Be.parentElementID=t,e.options.hideHeader=n,e.useDynamicHeignt(i)}}Be.parentElementID="extensionDropdownGeneratePassword",e.options.hideHeader=!0,e.useDynamicHeignt(!1)},postSetup:function(e){ExtensionLicenseExpiration.expiredCompanyStatusCheckerForPanelSize()?LPPlatform.setDropdownPopoverSize(e.$element.outerHeight(),c.outerWidth()+y.outerWidth()):ExtensionLicenseExpiration.expiredPremiumStatusCheckerForPanelSize()?LPPlatform.setDropdownPopoverSize(e.$element.outerHeight(),c.outerWidth()+y.outerWidth()):LPPlatform.setDropdownPopoverSize(e.$element.outerHeight()+y.outerHeight(),y.outerWidth())},onClose:function(){Fe(),ExtensionLicenseExpiration.expiredCompanyStatusCheckerForPanelSize()?A(c):ExtensionLicenseExpiration.expiredPremiumStatusCheckerForPanelSize()?A(c):D()},onCopy:function(){LPPlatform.closePopup(!0)},saveOptions:{source:"icon"}}),f.unbind("click",Ne),f.bind("click",Ne)},He=function(e,t,n,i,o){if(o=o||"Generic",e.isEmpty()){var a=LPTools.createElement("div","emptyView");a.appendChild(LPTools.createElement("img",{src:"images/vault_4.0/"+t+".png",class:"emptyViewIcon"})),a.appendChild(LPTools.createElement("h1","emptyViewText",n));var r=LPTools.createElement("input",{class:"addItem rbtn",type:"button",value:i,tabindex:-1});r.appendChild(LPTools.createElement("i","fa fa-trash")),a.appendChild(r),r.addEventListener("click",function(e){be(o)}),LPTools.addKeyBoardNavigation($(r),{selectFirst:!0}),document.getElementById("items").appendChild(a)}},Ve=function(e,t,n){if(e.isEmpty()){var i=LPTools.createElement("div","emptyView");i.appendChild(LPTools.createElement("img",{src:"images/vault_4.0/"+t,class:"emptyViewIcon"})),i.appendChild(LPTools.createElement("h1","emptyViewText",n)),document.getElementById("items").appendChild(i)}},Ge=function(){bg.LPPartner&&bg.LPPartner.getPartnerInfo&&bg.LPPartner.getPartnerInfo(function(e){e&&($(i).addClass("partner-logo"),_.attr("src",e.logoUrl).removeClass(e.class).addClass(e.class),S.show(),D())})};L.LP_addSearchHandlers("inputDialog",function(e){Se(e)}),f.bind("click",Fe);var Ke=function(e){Oe(we(e.target),{selectFirst:!e.originalEvent.isTrusted}),Te(e)};$("[childview]").bind("click",Ke),$("#addSite").bind("click",function(e){bg.get_selected_tab_data_no_extension(null,function(e){bg.lpevent("m_add"),$e({defaultData:{url:e?e.url:""}}),LPPlatform.closePopup()}),e.stopPropagation()}),$("#saveAllEnteredData").bind("click",function(){bg.lpevent("m_saed"),bg.get_selected_tab_data(null,function(e){bg.sendLpImprove("save_all_entered_data",{domain:bg.lp_gettld_url(e.url)})}),bg.saveall()}),$("#addNote").bind("click",function(){bg.lpevent("m_addn"),Me()}),$("#addFormFill").bind("click",function(){bg.lpevent("m_af"),De()}),$("#addCreditCard").bind("click",function(){bg.lpevent("m_af"),De({defaultData:{profiletype:FormFill.prototype.FORM_FILL_TYPE_CREDIT_CARD}})}),$("#clearForms").bind("click",function(){bg.lpevent("m_clrf"),bg.clearforms("icon")});var We=null,Ue,Ye,je,Ze;$("#chooseProfile").bind("click",function(){dialogs.chooseProfile.open({preSetup:function(e){if(null===We){var t=dialogs.chooseProfile.parentElementID,n=e.options.hideHeader;We=function(){dialogs.chooseProfile.parentElementID=t,e.options.hideHeader=n,e.$element.css("min-height","")}}e.$element.css("min-height",0),dialogs.chooseProfile.parentElementID="chooseProfileCreditCard",e.options.hideHeader=!0},onClose:function(){Fe()},saveOptions:{source:"icon"}})}),$("#vaultMenuItem").bind("click",function(){bg.lpevent("m_ov"),bg.openvault()}),$("#sitesMenuItem").bind("click",Ce("sites",function(e){N.rebuildItems(n,!e.originalEvent.isTrusted),Ve(N,"Empty_Site.png",Strings.translateString("Remember every password"))})),$("#formFillsMenuItem").bind("click",Ce("formFills",function(e){z.rebuildItems(n,!e.originalEvent.isTrusted),Ve(z,"Empty_Form.png",Strings.translateString("Fill Every Form"))})),$("#applicationsMenuItem").bind("click",Ce("applications",function(e){H.rebuildItems(n,!e.originalEvent.isTrusted),Ve(H,"Empty_Site.png",Strings.translateString("Remember every password"))})),$("#generateMenuItem").bind("click",ze),$("#notesMenuItem").bind("click",Ce("notes",function(e){R.rebuildItems(n,!e.originalEvent.isTrusted),Ve(R,"Empty_Note.png",Strings.translateString("Store Every Note"))})),$("#clearMostRecent").bind("click",function(){bg.clearrecent(),LPTools.removeDOMChildren(o),Ae(o)});var Xe=Ce("mostRecent",function(e){Z||(Le(),Z=!0),LPTools.addKeyBoardNavigation(o.children,{rightArrowSelector:".moreItem",selectFirst:!e.originalEvent.isTrusted,displayItems:W.getItems()})});I.bind("click",Xe);var qe=Ce("matchingSites",function(t){X||(Ie(s),X=!0),LPTools.addKeyBoardNavigation(e.getElementById("matchingSites").children,{rightArrowSelector:".moreItem",selectFirst:!t.originalEvent.isTrusted})});if(P.bind("click",qe),$("#prefMenuItem").bind("click",function(){bg.lpevent("m_op"),bg.openprefs()}),$("#helpMenuItem").bind("click",function(){bg.lpevent("m_oh"),bg.openhelp()}),$("#adminConsoleMenuItem").bind("click",function(){bg.lpevent("m_oec"),bg.openentconsole()}),$("#logoutMenuItem").bind("click",function(){bg.lpevent("m_lo"),bg.loggedOut(!1,"menu")}),$("#challengeMenuItem").bind("click",function(){bg.lpevent("m_sec"),bg.openseccheck()}),$("#favoritesMenuItem").bind("click",function(){bg.lpevent("m_of"),bg.openfavorites(!1,"icon")}),$("#aboutMenuItem").bind("click",function(){bg.lpevent("m_abt"),bg.openabout()}),b.bind("click",function(){bg.lpevent("m_dbgcon"),bg.opendebugtab()}),$("#csvExportMenuItem").bind("click",function(){bg.lpevent("m_e"),bg.openexport()}),$("#formFillExportMenuItem").bind("click",function(){bg.lpevent("m_eff"),bg.formfillexport()}),v.bind("click",function(){bg.lpevent("m_elp"),bg.openlastpassexport()}),h.bind("click",function(){bg.lpevent("m_ewlan"),bg.wlanexport()}),$("#printSitesMenuItem").bind("click",function(){bg.lpevent("m_p"),bg.openprint(!1)}),$("#printNotesMenuItem").bind("click",function(){bg.lpevent("m_pn"),bg.openprint(!0)}),$("#refreshMenuItem").bind("click",function(){bg.lpevent("m_ref"),LPProxy.refreshSites()}),$("#clearCachMenuItem").bind("click",function(){bg.lpevent("m_cl"),bg.clearCache(!1,!0,!1)}),$("#myAccountMenuItem").bind("click",function(){bg.lpevent("m_mya"),bg.openmyaccount()}),$("#sessionsMenuItem").bind("click",function(){bg.lpevent("m_ses"),bg.opensessions()}),LPPlatform.addEventListener(window,"unload",function(){tt()}),t.on("click",".extensionMenuItem, .footer, .contextOptionsDropdown",function(){LPPlatform.closePopup()}),LPFeatures.allowGift()){var Qe=$("#specialOfferMenuItem");Qe.show(),Qe.bind("click",function(){bg.openURL(LPProxy.getBaseURL()+"gift.php")})}$("#omarChallengeMenuItem").bind("click",function(){bg.lpevent("m_sec"),bg.openseccheck()}),$("#omarFavoritesMenuItem").bind("click",function(){bg.lpevent("m_of"),bg.openfavorites(!1,"icon")}),$("#omarPrefMenuItem").bind("click",function(){bg.lpevent("m_op"),bg.openprefs()}),$("#omarHelpMenuItem").bind("click",function(){bg.lpevent("m_oh"),bg.openhelp()}),$("#omarAboutMenuItem").bind("click",function(){bg.lpevent("m_abt"),bg.openabout()}),$("#omarRefreshMenuItem").bind("click",function(){bg.lpevent("m_ref"),LPProxy.refreshSites()}),$("#omarClearCachMenuItem").bind("click",function(){bg.lpevent("m_cl"),bg.clearCache(!1,!0,!1)}),$("#omarSessionsMenuItem").bind("click",function(){bg.lpevent("m_ses"),bg.opensessions()}),$("#safariMessageButton").bind("click",function(){bg.openURL("https://lastpass.com/safariAppExtension.php?source=dropdown"),LPPlatform.closePopup()}),Topics.get(Topics.REFRESH_DATA).subscribe(function(){pe()}),Topics.get(Topics.PUSH_STATE).subscribe(function(e){ee.push(e)}),Topics.get(Topics.EDIT_SITE).subscribe(function(e){e.vaultItem=e.vaultItem.getID(),$e(e)}),Topics.get(Topics.EDIT_NOTE).subscribe(function(e){e.vaultItem=e.vaultItem.getID(),Me(e)}),Topics.get(Topics.EDIT_FORM_FILL).subscribe(function(e){e.vaultItem=e.vaultItem.getID(),De(e)}),Topics.get(Topics.EDIT_APPLICATION).subscribe(function(e){e.vaultItem=e.vaultItem.getID(),bg.LPPlatform.openTabDialog("application",e)}),Topics.get(Topics.IDENTITY_ENABLE).subscribe(function(e){LPProxy.enableIdentity(e),O=e}),Topics.get(Topics.CONFIRM).subscribe(function(e){Je("confirmation",e)}),Topics.get(Topics.ERROR).subscribe(function(e){e&&Je("alert",{title:Strings.Vault.ERROR,text:e})}),Topics.get(Topics.REPROMPT).subscribe(function(e){Je("reprompt",{successCallback:e})}),Topics.get(Topics.LEFT_ARROW).subscribe(function(){LPTools.disableMouse(),Fe(!0)}),Topics.get(Topics.CLEAR_DATA).subscribe(function(){for(var e=ee.length-1;e>-1;--e)ee[e].pop();ee=[],LPTools.setNavIndex(0),L.val(""),Y=!1,j=!1,Z=!1,X=!1,q={},J={},Q=null,Re&&Re(),We&&We(),y.removeClass("initialized"),m.empty(),u.empty(),Dialog.prototype.closeAllDialogs(!0)}),Topics.get(Topics.INITIALIZED).subscribe(function(){Strings.translate(e.body),LPPlatform.setupDropdownImportMenu(y)});var Je=function(e,t){$("#container").LP_hide(),LPTools.removeKeyBoardNavigation(),t=$.extend(t,{onResize:function(e,t){LPPlatform.setDropdownPopoverSize(e,t)},onClose:function(){LPPlatform.closePopup()}}),LPDialog.openDialog(e,t)},et,tt=function(){Topics.get(Topics.CLEAR_DATA).publish()},nt,it=(ot=function(){bg.getData({context:"extensionDropdown",callback:function(){re()}})},at={},rt=function(e){LPPlatform.move(screenY-(e.screenY-at.y),e.screenX-at.x)},function(){C=!0,document.body.classList.add("quickSearch"),window.addEventListener("mousedown",function(e){e.target===document.getElementById("searchContainer")&&(at.x=e.clientX,at.y=e.clientY,window.addEventListener("mousemove",rt),e.preventDefault())}),window.addEventListener("mouseup",function(){window.removeEventListener("mousemove",rt)}),Topics.get(Topics.ESCAPE).subscribe(function(){LPPlatform.doClosePopup()}),Account.prototype.getDisplayClass=function(){return MatchingAccountDisplay},"undefined"!=typeof bg?ot():(Topics.get(Topics.INITIALIZED).subscribe(function(){ot()}),LPPlatform.initialize({context:"extensionDropdown",callback:ot}))}),ot,at,rt;return{setup:re,State:te,isMatchingSite:Pe,setGroupLabel:ne,open:function(){var e=bg.get("g_badgedata");if(e&&"notification"===e.cmd){switch(e.alerttype){case"duplicate":Je("duplicatePassword",{notification:e});break;case"weak":Je("weakPassword",{notification:e})}switch(e.type){case"error":Je("notification",{notification:bg.get("g_notification_data")});break;case"mpwchange":Je("securityNotice",{notification:bg.get("g_notification_data")});break;case"lpalert":Je("breachAlert",{notification:bg.get("g_notification_data")})}bg.clear_badge()}else e&&"migration"===e.cmd?(Je("migration",{notification:e}),bg.clear_badge()):re()},openDialog:Je,reset:tt,setBigIcons:function(e){bg.set("g_bigicons",e)},openQuickSearch:it,setSize:D}}(document);
//# sourceMappingURL=sourcemaps/extensionDropdown.js.map
