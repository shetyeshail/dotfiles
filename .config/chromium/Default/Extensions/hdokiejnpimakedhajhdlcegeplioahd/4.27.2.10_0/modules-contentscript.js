(function(){"use strict";var e=this,t,o,r;!function(e){var i,n,s,a,c={},u={},l={},p={},d=Object.prototype.hasOwnProperty,f=[].slice,m=/\.js$/;function y(e,t){return d.call(e,t)}function v(e,t){var o,r,i,n,s,a,c,u,p,d,f,y,v=t&&t.split("/"),g=l.map,h=g&&g["*"]||{};if(e){for(s=(e=e.split("/")).length-1,l.nodeIdCompat&&m.test(e[s])&&(e[s]=e[s].replace(m,"")),"."===e[0].charAt(0)&&v&&(e=(y=v.slice(0,v.length-1)).concat(e)),p=0;p<e.length;p++)if("."===(f=e[p]))e.splice(p,1),p-=1;else if(".."===f){if(0===p||1===p&&".."===e[2]||".."===e[p-1])continue;p>0&&(e.splice(p-1,2),p-=2)}e=e.join("/")}if((v||h)&&g){for(p=(o=e.split("/")).length;p>0;p-=1){if(r=o.slice(0,p).join("/"),v)for(d=v.length;d>0;d-=1)if((i=g[v.slice(0,d).join("/")])&&(i=i[r])){n=i,a=p;break}if(n)break;!c&&h&&h[r]&&(c=h[r],u=p)}!n&&c&&(n=c,a=u),n&&(o.splice(0,a,n),e=o.join("/"))}return e}function g(t,o){return function(){var r=f.call(arguments,0);return"string"!=typeof r[0]&&1===r.length&&r.push(null),n.apply(e,r.concat([t,o]))}}function h(e){return function(t){return v(t,e)}}function b(e){return function(t){c[e]=t}}function S(t){if(y(u,t)){var o=u[t];delete u[t],p[t]=!0,i.apply(e,o)}if(!y(c,t)&&!y(p,t))throw new Error("No "+t);return c[t]}function w(e){var t,o=e?e.indexOf("!"):-1;return o>-1&&(t=e.substring(0,o),e=e.substring(o+1,e.length)),[t,e]}function _(e){return e?w(e):[]}function F(e){return function(){return l&&l.config&&l.config[e]||{}}}s=function(e,t){var o,r=w(e),i=r[0],n=t[1];return e=r[1],i&&(o=S(i=v(i,n))),i?e=o&&o.normalize?o.normalize(e,h(n)):v(e,n):(i=(r=w(e=v(e,n)))[0],e=r[1],i&&(o=S(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:o}},a={require:function(e){return g(e)},exports:function(e){var t=c[e];return void 0!==t?t:c[e]={}},module:function(e){return{id:e,uri:"",exports:c[e],config:F(e)}}},i=function(t,o,r,i){var n,l,d,f,m,v,h=[],w=typeof r,F;if(v=_(i=i||t),"undefined"===w||"function"===w){for(o=!o.length&&r.length?["require","exports","module"]:o,m=0;m<o.length;m+=1)if("require"===(l=(f=s(o[m],v)).f))h[m]=a.require(t);else if("exports"===l)h[m]=a.exports(t),F=!0;else if("module"===l)n=h[m]=a.module(t);else if(y(c,l)||y(u,l)||y(p,l))h[m]=S(l);else{if(!f.p)throw new Error(t+" missing "+l);f.p.load(f.n,g(i,!0),b(l),{}),h[m]=c[l]}d=r?r.apply(c[t],h):void 0,t&&(n&&n.exports!==e&&n.exports!==c[t]?c[t]=n.exports:d===e&&F||(c[t]=d))}else t&&(c[t]=r)},t=o=n=function(t,o,r,c,u){if("string"==typeof t)return a[t]?a[t](o):S(s(t,_(o)).f);if(!t.splice){if((l=t).deps&&n(l.deps,l.callback),!o)return;o.splice?(t=o,o=r,r=null):t=e}return o=o||function(){},"function"==typeof r&&(r=c,c=u),c?i(e,t,o,r):setTimeout(function(){i(e,t,o,r)},4),n},n.config=function(e){return n(e)},t._defined=c,(r=function(e,t,o){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(o=t,t=[]),y(c,e)||y(u,e)||(u[e]=[e,t,o])}).amd={jQuery:!0}}();var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(i,n){function s(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new o(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},r,i,n,s;return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(e){return function(t){return c([e,t])}}function c(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},a=this&&this.__decorate||function(e,t,o,r){var i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r,s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(n=(i<3?s(n):i>3?s(t,o,n):s(t,o))||n);return i>3&&n&&Object.defineProperty(t,o,n),n},c=this&&this.__extends||(u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),u;r("common/services/form-detection/form-profile",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/services/form-detection/index",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/enums/auto-fill-action",["require","exports"],function(e,t){var o,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=o=t.AutoFillAction||(t.AutoFillAction={})).Login="Login",r.Email="Email",r.Address="Address",r.PersonalName="PersonalName"}),r("common/enums/auto-fill-input-category",["require","exports"],function(e,t){var o,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=o=t.AutoFillInputCategory||(t.AutoFillInputCategory={})).Name="name",r.FullName="fullName",r.FirstName="firstName",r.LastName="lastName",r.Address="address",r.Email="email",r.Password="password",r.UserName="userName"}),r("common/enums/auto-fill-method",["require","exports"],function(e,t){var o,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=o=t.AutoFillAlgorithm||(t.AutoFillAlgorithm={})).Legacy="Legacy",r.Euclidean="Euclidean"}),r("common/enums/feature-type",["require","exports"],function(e,t){var o,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=o=t.FeatureType||(t.FeatureType={})).AngularFrontendEnabled="angularFrontendEnabled",r.AutoFillControl="autofill_control",r.AutoFillTest="autofill_test",r.BetterGeneratePasswordEnabled="better_generate_password_enabled",r.Block30="block_3_0",r.EmergencyAccessRestricted="emergency_access_restricted",r.FamiliesEnabled="families_enabled",r.FamilyLegacySharedFoldersEnabled="family_legacy_shared_folders_enabled",r.FamilySharedFoldersEnabled="family_shared_folders_enabled",r.FormfillMigration="formfill_migration",r.Freamon="freamon",r.HealthMonitoring="health_monitoring",r.ICOB="icob",r.IntroTutorialVersion="intro_tutorial_version",r.IsDogfood="isDogfood",r.IsInfieldEnabled="is_infield_enabled",r.IsMobileActive="is_mobile_active",r.NewSaveSite="new_save_site",r.OmarDrawer="omardrawer",r.OmarIa="omaria",r.OmarInfieldB="omar_infield_b",r.OmarInfieldC="omar_infield_c",r.OneToOneSharingRestricted="one_to_one_sharing_restricted",r.PasswordSubmittedEvent="password_submitted_event",r.Pdkdf2IterationsMigration="pbkdf2_iterations_migration",r.Retire30="retire_3_0",r.TryFamiliesEnabled="try_families_enabled",r.WebRequestEnabled="save_a_site_web_request",r.Ziggy="ziggy"}),r("common/enums/repository-type",["require","exports"],function(e,t){var o,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=o=t.RepositoryType||(t.RepositoryType={})).Feature="Feature",r.AutoFillState="AutoFillState"}),r("common/enums/resolver-type",["require","exports"],function(e,t){var o,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=o=t.ResolverType||(t.ResolverType={})).PasswordSubmitted="Password Submitted",r.InjectedPasswordSubmitted="Injected Password Submitted"}),r("common/enums/save-site-action",["require","exports"],function(e,t){var o,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=o=t.SaveSiteAction||(t.SaveSiteAction={})).Add="Add",r.OK="OK",r.Update="Update",r.NotNow="Not Now",r.Undo="Undo",r.Never="Never"}),r("common/enums/save-site-event-type",["require","exports"],function(e,t){var o,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=o=t.SaveSiteDialogEventType||(t.SaveSiteDialogEventType={})).SaveSiteDialogAction="Save a Site Action Clicked",r.SaveSiteDialogDuplicateDeleteClicked="Save a Site Duplicate Delete Clicked",r.SaveSiteDialogDuplicateKeepClicked="Save a Site Duplicate Keep Clicked",r.SaveSiteDialogEditClicked="Save a Site Edit Clicked",r.SaveSiteDialogNewClicked="Save a Site New Clicked",r.SaveSiteDialogSelectClicked="Save a Site Select Clicked",r.SaveSiteDialogViewed="Save a Site Viewed",r.SaveSiteDialogAnotherClicked="Save a Site Another Clicked"}),r("common/enums/segment-event-type",["require","exports"],function(e,t){var o,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=o=t.SegmentEventType||(t.SegmentEventType={})).SaveSiteDialog="savesitedialog"}),r("common/enums/service-type",["require","exports"],function(e,t){var o,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=o=t.ServiceType||(t.ServiceType={})).BasicAuth="BasicAuth",r.ContentScriptTools="ContentScriptTools",r.DomUtils="DomUtils",r.FormDetection="FormDetection",r.AutoFill="AutoFill",r.FormParser="FormParser",r.Segment="Segment",r.Site="Site",r.StringUtils="StringUtils",r.Topic="Topic",r.WebRequest="WebRequest",r.WebRequestShim="WebRequestShim"}),r("common/enums/topic-type",["require","exports","common/legacy"],function(e,t,o){var r,i;Object.defineProperty(t,"__esModule",{value:!0}),(i=r=t.TopicType||(t.TopicType={}))[i.ClearData=o.LegacyGlobalCommon.Topics.CLEAR_DATA]="ClearData",i[i.FilledGeneratedPassword=o.LegacyGlobalCommon.Topics.FILLED_GENERATED_PW]="FilledGeneratedPassword",i[i.Initialized=o.LegacyGlobalCommon.Topics.INITIALIZED]="Initialized",i[i.Login=o.LegacyGlobalCommon.Topics.LOGIN]="Login",i[i.LoginFinished=o.LegacyGlobalCommon.Topics.LOGIN_FINISHED]="LoginFinished",i[i.ProcessedFormSubmit=o.LegacyGlobalCommon.Topics.PROCESSED_FORM_SUBMIT]="ProcessedFormSubmit",i[i.RequestFrameworkInitialized=o.LegacyGlobalCommon.Topics.REQUEST_FRAMEWORK_INITIALIZED]="RequestFrameworkInitialized",i[i.PasswordFormSubmitted=o.LegacyGlobalCommon.Topics.PASSWORD_FORM_SUBMITTED]="PasswordFormSubmitted"}),r("common/enums/index",["require","exports","common/enums/auto-fill-action","common/enums/auto-fill-input-category","common/enums/auto-fill-method","common/enums/feature-type","common/enums/repository-type","common/enums/resolver-type","common/enums/save-site-action","common/enums/save-site-event-type","common/enums/segment-event-type","common/enums/service-type","common/enums/topic-type"],function(e,t,o,r,i,n,s,a,c,u,l,p,d){function f(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}Object.defineProperty(t,"__esModule",{value:!0}),f(o),f(r),f(i),f(n),f(s),f(a),f(c),f(u),f(l),f(p),f(d)}),r("common/repositories/auto-fill-state/auto-fill-algorithm-state",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/repositories/auto-fill-state/auto-fill-frame-state",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/repositories/auto-fill-state/auto-fill-state",["require","exports","common/enums/index"],function(e,t,o){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.tabId=e,this.url=t,this.frames={}}return Object.defineProperty(e.prototype,"isReady",{get:function(){var e=this;return Object.keys(this.frames).every(function(t){var o=e.frames[t];return o.isReady||!o.isAllowed})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAllowed",{get:function(){var e=this;return Object.keys(this.frames).every(function(t){return e.frames[t].isAllowed})},enumerable:!0,configurable:!0}),e.prototype.tryGetFrame=function(e){return this.frames[e]||(this.frames[e]=this.getEmptyFrame()),this.frames[e]},e.prototype.getEmptyFrame=function(){return{elements:{},isAllowed:!0,isReady:!1}},e.prototype.setFrameAllowed=function(e,t){var o;this.tryGetFrame(e).isAllowed=t},e.prototype.setFrameReady=function(e,t){var o;this.tryGetFrame(e).isReady=t},e.prototype.getFrameAlgorithmState=function(e,t,o){var r=this.tryGetFrame(e);if(r.elements[t])return r.elements[t][o]},e.prototype.setFrameAlgorithmState=function(e,t,o,r){var n=this.tryGetFrame(e),s=n.elements[t];s||(s={},n.elements[t]=s),n.elements[t][o]=i({},s[o],r)},e.prototype.resetFrameState=function(e){this.frames[e]&&(this.frames[e]=this.getEmptyFrame())},e.prototype.deleteFrameState=function(e){this.frames[e]&&delete this.frames[e]},e.prototype.getResults=function(){var e=this,t={count:0};Object.keys(o.AutoFillAlgorithm).forEach(function(e){t[e]=0});var r={allowed:this.isAllowed,userName:i({},t),password:i({},t)};return Object.keys(this.frames).forEach(function(n){var s=e.frames[n];s.isAllowed&&s.isReady&&Object.keys(s.elements).forEach(function(e){return Object.keys(s.elements[e]).forEach(function(n){var a,c=s.elements[e][n].filledWith;if(c&&"none"!==c){r[c]||(r[c]=i({},t));var u=r[c][n]+1;n===o.AutoFillAlgorithm.Legacy&&(r[c].count=u),r[c][n]=u}})})}),r},e}();t.AutoFillState=r}),r("common/repositories/auto-fill-state/index",["require","exports","common/repositories/auto-fill-state/auto-fill-state"],function(e,t,o){function r(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}Object.defineProperty(t,"__esModule",{value:!0}),r(o)}),r("common/interfaces/auto-fill-state.repository",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/interfaces/auto-fill.service",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/interfaces/feature.repository",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/interfaces/repository",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/interfaces/segment.service",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/interfaces/segment-event",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/interfaces/serializable-callback",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/interfaces/serializable-value",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/interfaces/service",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/interfaces/web-request-shim.service",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/interfaces/web-request.service",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/interfaces/index",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("background/interfaces/content-script-target",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("background/services/form-parser/form-meta-data",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){var t=this;this.passwordsByValue={},this.textFieldsByValue={},this.textFieldsByType={},this.uniqueTextValues=[],this.uniquePasswords=[],e.fields&&(e.fields.forEach(function(e){"password"===e.type?t.aggregateField(e,e.value,t.passwordsByValue):(t.aggregateField(e,e.value,t.textFieldsByValue),t.aggregateField(e,e.type,t.textFieldsByType))}),this.uniqueTextValues=Object.keys(this.textFieldsByValue),this.uniquePasswords=Object.keys(this.passwordsByValue))}return e.prototype.aggregateField=function(e,t,o){var r=o[t];r?++r.count:o[t]={field:e,count:1}},e}();t.FormMetaData=o}),r("background/interfaces/parsed-form",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("background/interfaces/index",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("background/interfaces/legacy",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/interfaces/legacy",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/legacy",["require","exports"],function(t,o){Object.defineProperty(o,"__esModule",{value:!0}),o.LegacyGlobalCommon=e}),r("common/module.abstract",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){var e=this;this._isInitialized=!1,this.initializedQueue=[],setTimeout(function(){return n(e,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.initialize()];case 1:return e.sent(),[4,this.postInitialize()];case 2:for(e.sent(),this._isInitialized=!0;this.initializedQueue.length;)try{this.initializedQueue.pop()()}catch(e){console.error(e)}return[2]}})})})}return e.prototype.isInitialized=function(e){this._isInitialized?e():this.initializedQueue.push(e)},e}();t.ModuleAbstract=o}),r("common/provider.abstract",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){void 0===t&&(t=!0);var o=this;this.instances={},this.initialized=!1,e&&e.size&&(this.map=e,this.map.forEach(function(e,r){e.delegated&&!t||(o.instances[r]=new e.ctor)}))}return e.prototype.initialize=function(){var e=this;Object.keys(this.instances).forEach(function(t){return e.instances[t].initialize()}),this.initialized=!0},e.prototype.postInitialize=function(){var e=this;Object.keys(this.instances).forEach(function(t){"function"==typeof e.instances[t].postInitialize&&e.instances[t].postInitialize()})},e.prototype.teardown=function(){var e=this;Object.keys(this.instances).forEach(function(t){e.instances[t]&&"function"==typeof e.instances[t].destroy&&e.instances[t].destroy()})},e}();t.ProviderAbstract=o}),r("common/decorators/register-repository.decorator",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=new Map;function r(e,t){return void 0===t&&(t=!1),function(r){o.set(e,{ctor:r,delegated:t})}}function i(){return o}t.RegisterRepository=r,t.getRepositoryRegistry=i}),r("common/decorators/register-service.decorator",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=new Map;function r(e,t){return void 0===t&&(t=!1),function(r){o.set(e,{ctor:r,delegated:t})}}function i(){return o}t.RegisterService=r,t.getServiceRegistry=i}),r("common/messaging/messaging",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=new WeakMap;function r(e,t){var r=e.constructor,i=o.get(r);i&&i.size?i.add(t):i=new Set([t]),o.set(r,i)}t.addVisibleMethod=r;var i=null;function a(){return i}function c(e,t,r,a,c){return void 0===r&&(r=[]),n(this,void 0,void 0,function(){var n,l,p;return s(this,function(s){switch(s.label){case 0:if(s.trys.push([0,3,4,5]),!e||!e.constructor)throw new Error("No target provided!");if(!o.has(e.constructor))throw new Error("Target has no visible methods.");if(!o.get(e.constructor).has(t))throw new Error("Method [ "+t+" ] is not a visible method.");if("function"!=typeof(n=e[t]))throw new Error("Method [ "+t+" ] is not a function or does not exist on the target.");return i=Object.freeze({calleeTab:Object.freeze(c)}),(l=n.bind(e).apply(void 0,r))&&"function"==typeof l.then?[4,l]:[3,2];case 1:l=s.sent(),s.label=2;case 2:return a(null,l),[3,5];case 3:return u(p=s.sent(),a),[3,5];case 4:return i=null,[7];case 5:return[2]}})})}function u(e,t){if("function"==typeof t){var o=void 0;"string"==typeof e?o=e:e instanceof Error&&(o="string"==typeof e.message?e.message:"function"==typeof e.toString?e.toString():"Unknown error"),t(o)}else console.error(e)}t.getInvokatingMessageContext=a,t.callMethod=c,t.handleCallbackError=u}),r("common/decorators/visible.decorator",["require","exports","common/messaging/messaging"],function(e,t,o){function r(e,t,r){o.addVisibleMethod(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Visible=r}),r("common/decorators/index",["require","exports","common/decorators/register-repository.decorator","common/decorators/register-service.decorator","common/decorators/visible.decorator"],function(e,t,o,r,i){function n(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}Object.defineProperty(t,"__esModule",{value:!0}),n(o),n(r),n(i)}),r("common/interfaces/site.service",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("common/services/topic/topic.service",["require","exports","common/decorators/index","common/enums/index","common/legacy"],function(e,t,o,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.initialize=function(){},e.prototype.subscribe=function(e,t){i.LegacyGlobalCommon.Topics.get(e).subscribe(function(e){return t(e)})},e=a([o.RegisterService(r.ServiceType.Topic)],e)}();t.TopicService=n}),r("common/services/utils/string-utils.service",["require","exports","common/decorators/index","common/enums/index"],function(e,t,o,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.prototype.initialize=function(){},e.prototype.stringContains=function(e,t){if(e&&t){Array.isArray(t)||(t=[t]);for(var o=0;o<t.length;++o)if(e.indexOf(t[o])>-1)return!0}return!1},e.prototype.containsMaskingCharacter=function(e){return e.indexOf("*")>-1||e.indexOf(String.fromCharCode(8226))>-1},e=a([o.RegisterService(r.ServiceType.StringUtils)],e)}();t.StringUtilsService=i}),r("content-script/interfaces/content-script-instances-info",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("content-script/interfaces/index",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("content-script/services/auto-fill/algorithms/algorithm-result",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("content-script/services/auto-fill/algorithms/algorithm.abstract",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e}();t.AlgorithmAbstract=o}),r("content-script/services/auto-fill/algorithms/euclidean-distance-algorithm",["require","exports","common/enums/index","common/enums/index","content-script/services/auto-fill/algorithms/algorithm.abstract","content-script/content-script.module"],function(e,t,o,r,i,n){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=e.call(this)||this;return t.autoFillService=n.getService(r.ServiceType.AutoFill),t}return c(t,e),t.prototype.execute=function(e){var o=this,r=Array.from(document.querySelectorAll('input[type="text"], input:not([type]), input[type="password"], input[type="email"]')),i=[],n=new Map;r.forEach(function(e){var r=o.autoFillService.getInputElementData(e);if(r.visible)for(var i=[r.id,r.type,r.ariaLabel,r.name],s=new Map,a=0,c=i;a<c.length;a++){var u=c[a];if(u){var l=o.getFitResults(u,t.inputWords);if(l&&l.matches.length){for(var p=0,d=l.matches;p<d.length;p++){var f=d[p];s.has(f.inputCategory)?s.set(f.inputCategory,s.get(f.inputCategory)+f.confidence):s.set(f.inputCategory,f.confidence)}l.matches.sort(function(e,t){return s.get(t.inputCategory)-s.get(e.inputCategory)});var m=l.matches[0];if(m){var y=void 0;n.has(e)?(y=n.get(e)).bestMatch.inputCategory===m.inputCategory?y.bestMatch.confidence+=m.confidence:n.get(e).bestMatch.confidence<m.confidence&&(y={fitResults:l,bestMatch:m}):y={fitResults:l,bestMatch:m},n.set(e,y)}}}}});var s=new Map;return n.forEach(function(o,r){var n=o.fitResults,a=o.bestMatch;if(e.some(function(e){return e===a.inputCategory})){var c=n.matches[0].confidence>t.FitThreshold&&n.matches[0].confidence-n.matches[1].confidence>t.FitSeparation,u=s.get(a.inputCategory);u&&u.matches[0].confidence>a.confidence||(s.set(a.inputCategory,n),i.push({inputElement:r,inputValue:n.value,inputValueNormalized:n.valueNormalized,category:a.inputCategory,closestMatchingWord:a.closestMatchingWord,isMatching:c,confidence:a.confidence}))}}),i},t.prototype.similarity=function(e,t){var o=e,r=t;e.length<t.length&&(o=t,r=e);var i=o.length;return 0===i?1:(i-this.editDistance(o,r))/i},t.prototype.editDistance=function(e,t){for(var o=Array.from(e.toLowerCase()),r=Array.from(t.toLowerCase()),i=[],n=0;n<=o.length;n++){for(var s=n,a=0;a<=r.length;a++)if(0===n)i[a]=a;else if(a>0){var c=i[a-1];o[n-1]!==r[a-1]&&(c=1+Math.min(Math.min(c,s),i[a])),i[a-1]=s,s=c}n>0&&(i[t.length]=s)}return i[t.length]},t.prototype.normalizeAttributeValue=function(e){return e.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()},t.prototype.findBestMatch=function(e,t,o){for(var r=0,i=null,n=NaN,s=0;s<t.length;s++)(n=this.similarity(t[s],o))>r&&(r=n,i=s);return{inputCategory:e,closestMatchingWord:t[i],confidence:100*Number(r.toFixed(2))}},t.prototype.getFitResults=function(e,t){var o=this,r=this.normalizeAttributeValue(e),i=Object.keys(t).map(function(e){return o.findBestMatch(e,t[e],r)}),n;return i.sort(function(e,t){return t.confidence-e.confidence}),{value:e,valueNormalized:r,matches:i}},t.FitThreshold=80,t.FitSeparation=10,t.inputWords=function(){var e;function t(e,t){var o=[];return e.forEach(function(e){return t.forEach(function(t){return o.push(e+t)})}),o}var r=["first","1st","f","front","head","primary","prime","initial","cardinal","1st","1","proper"],i=["last","end","final","l"],n=["full","whole","entire"],s=["name","n","nombre"],a=["address","addr"],c=["email","e","mailto","emailaddress","useremail","emailuser"],u=["password","pass","pw","p","pwd"],l=["user","uname","username","nameuser","u","accountname"];return(e={})[o.AutoFillInputCategory.Name]=s,e[o.AutoFillInputCategory.FullName]=t(n,s),e[o.AutoFillInputCategory.FirstName]=t(r,s),e[o.AutoFillInputCategory.LastName]=t(i,s),e[o.AutoFillInputCategory.Address]=a,e[o.AutoFillInputCategory.Email]=c,e[o.AutoFillInputCategory.Password]=u,e[o.AutoFillInputCategory.UserName]=l,e}(),t}(i.AlgorithmAbstract);t.EuclideanDistanceAlgorithm=s}),r("content-script/services/auto-fill/algorithms/index",["require","exports","content-script/services/auto-fill/algorithms/euclidean-distance-algorithm"],function(e,t,o){function r(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}Object.defineProperty(t,"__esModule",{value:!0}),r(o)}),r("content-script/services/auto-fill/post-processors/login-post-processor",["require","exports","common/enums/index"],function(e,t,o){function r(e){if(!e.some(function(e){return e.category===o.AutoFillInputCategory.UserName})){var t=e.filter(function(e){return e.category===o.AutoFillInputCategory.Password}),r=e.filter(function(e){return e.category===o.AutoFillInputCategory.Email});t.length<=1&&1===r.length&&(r[0].category=o.AutoFillInputCategory.UserName)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.loginPostProcess=r}),r("content-script/services/auto-fill/auto-fill.service",["require","exports","common/decorators/index","common/enums/index","content-script/services/auto-fill/post-processors/login-post-processor","content-script/services/auto-fill/algorithms/index","content-script/content-script.module"],function(e,t,o,r,i,c,u){var l;Object.defineProperty(t,"__esModule",{value:!0});var p=r.AutoFillAction,d=r.AutoFillInputCategory,f=function(){function e(){}var t;return t=e,e.prototype.initialize=function(){this.contentScriptTools=u.getService(r.ServiceType.ContentScriptTools),this.autoFillStateRepo=u.getRepository(r.RepositoryType.AutoFillState),this.featureRepository=u.getRepository(r.RepositoryType.Feature)},e.prototype.postInitialize=function(){return n(this,void 0,void 0,function(){var e,t,o,i,n,a,c=this;return s(this,function(s){switch(s.label){case 0:return[4,this.featureRepository.get(r.FeatureType.AutoFillTest)];case 1:return(e=s.sent())?(t=u.getContentScriptInstanceInfo(),o=t.tabId,i=t.frameId,n=t.isTop,"loading"===window.document.readyState?(a=function(e){c.autoFillStateRepo.resetFrameState(o,i),c.fill(r.AutoFillAction.Login),window.removeEventListener("DOMContentLoaded",a)},window.addEventListener("DOMContentLoaded",a)):this.fill(r.AutoFillAction.Login),window.addEventListener("beforeunload",function(e){n?c.autoFillStateRepo.deleteState(o):c.autoFillStateRepo.deleteFrameState(o,i)}),[2]):[2]}})})},e.prototype.getInputElementData=function(e){var t=e.getBoundingClientRect(),o=t.left,r=t.top;return{width:e.width,height:e.height,visible:this.contentScriptTools.isVisible(e),position:{left:o,top:r},id:this.contentScriptTools.getAttribute(e,"id"),type:this.contentScriptTools.getAttribute(e,"type"),name:this.contentScriptTools.getAttribute(e,"name"),value:this.contentScriptTools.getAttribute(e,"value"),ariaLabel:this.contentScriptTools.getAttribute(e,"aria-label"),raw:e}},e.prototype.fill=function(e){var o,n=(new c.EuclideanDistanceAlgorithm).execute(t.actionInputMap[e]);(e=r.AutoFillAction.Login)&&(n=i.loginPostProcess(n));for(var s=u.getContentScriptInstanceInfo(),a=s.tabId,l=s.frameId,p=0,d=n;p<d.length;p++){var f=d[p],m=void 0;switch(f.category){case r.AutoFillInputCategory.Password:m="password";break;case r.AutoFillInputCategory.UserName:m="userName";break;default:m="other"}this.autoFillStateRepo.setFrameAlgorithmState(a,l,f.inputElement,r.AutoFillAlgorithm.Euclidean,{inputCategory:f.category,elementType:f.inputElement.type,filledWith:m})}},e.actionInputMap=((l={})[p.Login]=[d.Email,d.UserName,d.Password],l[p.Email]=[d.Email],l[p.Address]=[d.Address],l[p.PersonalName]=[d.FullName,d.FirstName,d.LastName],l),a([o.Visible],e.prototype,"fill",null),e=t=a([o.RegisterService(r.ServiceType.AutoFill)],e)}();t.AutoFillService=f}),r("content-script/services/site/delegated-site.service",["require","exports","content-script/services/index","common/enums/index","common/decorators/index"],function(e,t,o,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.initialize=function(){},e.prototype.getUserNames=function(e){return o.callBackgroundService(r.ServiceType.Site,"getUserNames",[e])},e=a([i.RegisterService(r.ServiceType.Site,!0)],e)}();t.DelegatedSiteService=n}),r("content-script/interfaces/legacy",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),r("content-script/legacy",["require","exports"],function(t,o){Object.defineProperty(o,"__esModule",{value:!0}),o.LegacyGlobal=e}),r("content-script/services/form-detection/form-detection.service",["require","exports","common/decorators/index","common/enums/index","content-script/content-script.module","content-script/legacy"],function(e,t,o,r,i,c){Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(){var e=this;this.inputSelector='input:not([type]),input[type="text"],input[type="email"],input[type="password"],input[type="hidden"]',this.inputAttributes=["name","ng-model","data-reactid","id"],this.inputMap=new Map,this.formMap=new Map,this.hasPasswordInput=!1,this.saveSiteDialogIsDisplayed=!1,this.hasGeneratedPasswordSinceLastAutofill=!1,this.updateInputMaps=function(){Array.from(e.inputMap.entries()).forEach(function(t){var o=t[0];e.removeMappedInput(o)}),Array.from(e.formMap.entries()).forEach(function(t){var o=t[0];e.removeMappedForm(o)}),e.hasPasswordInput=!1,Array.from(document.querySelectorAll("form")).forEach(e.addMappedForm),Array.from(document.querySelectorAll("input")).forEach(e.addMappedInput),e.saveSiteDialogIsDisplayed=null!==document.getElementById("siteDialog"),e.hasPasswordInput=Array.from(e.inputMap.values()).some(function(e){return"password"===e.type})},this.addMappedForm=function(t){t.addEventListener("submit",e.submitListener),t.addEventListener("keydown",e.formKeydownListener),e.formMap.has(t)||e.formMap.set(t,e.createFormProfile())},this.removeMappedForm=function(t){e.formMap.delete(t)&&t.removeEventListener("submit",e.submitListener)},this.addMappedInput=function(t){var o=e.getInputType(t);t.addEventListener("change",e.changeListener),t.addEventListener("keydown",e.keydownListener),"password"===o&&t.addEventListener("blur",e.blurListener);var r={value:t.value,attributes:e.tools.getAttributes(t,e.inputAttributes),label:e.tools.getElementLabel(t),type:o},i;e.inputMap.set(t,r),e.getFormProfile(t).fields.push(r),e.hasPasswordInput=e.hasPasswordInput||"password"===o},this.removeMappedInput=function(t){var o=e.getFormProfile(t),r=e.inputMap.get(t),i=o.fields.indexOf(r);i>-1&&o.fields.splice(i,1),e.inputMap.delete(t)&&(t.removeEventListener("change",e.changeListener),t.removeEventListener("keydown",e.keydownListener))},this.changeListener=function(t){t.isTrusted&&(e.setFieldValue({input:t.target,fromUser:!0}),e.trackForms())},this.keydownListener=function(t){t.isTrusted&&13===(t.keyCode||t.which)&&(e.setFieldValue({input:t.target,fromUser:!0}),e.trackForms())},this.formKeydownListener=function(t){t.isTrusted&&13===(t.keyCode||t.which)&&(e.getInputs().forEach(e.addMappedInput),e.setFieldValue({input:t.target,fromUser:!0}),e.trackForms())},this.blurListener=function(t){t.isTrusted&&(e.getInputs().forEach(e.addMappedInput),e.setFieldValue({input:t.target,fromUser:!0}),e.trackForms())},this.submitListener=function(t){t.isTrusted&&e.trackForms(!0)},this.trackForms=function(t){void 0===t&&(t=!1),e.hasPasswordInput&&(t&&Array.from(e.inputMap.entries()).forEach(function(t){var o=t[0],r=t[1];e.setFieldValue({input:o,field:r})}),e.tools.debounce(e.webRequest.trackFormSubmission,200,!0).call(e,e.csInfo.tabId,Array.from(e.formMap.values()).concat([e.orphansFormProfile])))},this.getInputType=function(t){return"password"===t.type||"disc"===e.tools.getCSS(t,"text-security")?"password":"email"===t.type||"hidden"===t.type?t.type:"text"},this.getInputs=function(t){void 0===t&&(t=document.body);var o=t===document.body?e.documentBodyInputs:Array.from(t.querySelectorAll(e.inputSelector)),r=[],i=new Map;if(o.forEach(function(t){if(e.tools.isVisible(t))(""===t.value&&""===t.getAttribute("value")||t.value!==t.getAttribute("value")||t.value.length>1)&&r.push(t);else if(["hidden","text","email"].indexOf(t.type)>-1){var o=i.get(t.value)||{matches:0,inputs:[]};o.inputs.push(t),i.set(t.value,o)}}),i.size){for(var n=i.entries(),s=void 0;!(s=n.next()).done;)s.value[1].inputs.length>1&&i.delete(s.value[0]);for(var a=Array.from(i.keys()),c=document.createTreeWalker(document,NodeFilter.SHOW_TEXT),u=function(){var t=c.currentNode;if(["OPTION","SCRIPT"].some(function(e){return t.parentElement.nodeName===e}))return"continue";var o=t.nodeValue.trim();if(a.some(function(e){return e===o})){if(!e.tools.isVisible(t))return"continue";var r=i.get(o);r.matches++,i.set(o,r)}};c.nextNode();)u();for(n=i.entries();!(s=n.next()).done;)1===s.value[1].matches&&r.push(s.value[1].inputs[0])}return r},this.setFieldValue=function(t){var o=t.input,r=t.field,i=t.fromUser,n=void 0!==i&&i;r=r||e.inputMap.get(o);var s=e.getFormProfile(o),a=o.value;if("password"===r.type)!a||r.dirty||s.originalPassword||(s.originalPassword=r.value),s.currentPassword=a||"";else{if(e.stringUtils.containsMaskingCharacter(a))if(r.value&&r.value!==a&&!e.stringUtils.containsMaskingCharacter(r.value))a=r.value;else{var c=s.fields.filter(function(t){return!(t===r||!t.value||e.stringUtils.containsMaskingCharacter(t.value)||t.value.length!==a.length||t.value[0]!==a[0]&&t.value[t.value.length-1]!==r.value[a.length-1])})[0];c&&(a=c.value)}e.siteUserNames.some(function(e){return e===a})?s.username=a:s.username===r.value&&(s.username=a)}r.dirty=r.dirty||n,r.value=a},this.getFormProfile=function(t){var o;return console.assert(t instanceof HTMLInputElement,"Input argument is not an HTMLInputElement"),t.form?(o=e.formMap.get(t.form))||(o=e.createFormProfile(),e.formMap.set(t.form,o)):o=e.orphansFormProfile,o}}return e.prototype.initialize=function(){var e=this,t;if(this.siteService=i.getService(r.ServiceType.Site),this.stringUtils=i.getService(r.ServiceType.StringUtils),this.tools=i.getService(r.ServiceType.ContentScriptTools),this.webRequest=i.getService(r.ServiceType.WebRequest),this.csInfo=i.getContentScriptInstanceInfo(),i.getService(r.ServiceType.Topic).subscribe(r.TopicType.FilledGeneratedPassword,function(t){var o=t.element,r=t.password,i=e.getFormProfile(o);e.handleGeneratedPassword(r,i)}),"loading"!==document.readyState)this.onDocumentReady();else{var o=function(){e.onDocumentReady(),document.removeEventListener("DOMContentLoaded",o)};document.addEventListener("DOMContentLoaded",o)}},e.prototype.getHasGeneratedPasswordSinceLastAutofill=function(){return this.hasGeneratedPasswordSinceLastAutofill},e.prototype.setHasGeneratedPasswordSinceLastAutofill=function(e){this.hasGeneratedPasswordSinceLastAutofill=e},e.prototype.onDocumentReady=function(){return n(this,void 0,void 0,function(){var e,t,o=this;return s(this,function(r){switch(r.label){case 0:return this.orphansFormProfile=this.createFormProfile(),this.orphansFormProfile.containsOrphans=!0,e=this,[4,this.siteService.getUserNames(document.location.hostname)];case 1:return e.siteUserNames=r.sent(),this.documentBodyInputs=Array.from(document.body.querySelectorAll(this.inputSelector)),this.getInputs().forEach(this.addMappedInput),Array.from(document.querySelectorAll("form")).forEach(this.addMappedForm),window.addEventListener("lprequeststart",function(){return o.trackForms(!0)}),t=this.tools.debounce(this.updateInputMaps,200,!1).bind(this),this.observer=new MutationObserver(t),this.observer.observe(document,{attributes:!0,attributeFilter:this.inputAttributes,childList:!0,subtree:!0}),setTimeout(function(){Array.from(o.inputMap.keys()).forEach(function(e){o.setFieldValue({input:e})})},10),[2]}})})},e.prototype.handleGeneratedPassword=function(e,t){return n(this,void 0,void 0,function(){return s(this,function(o){return t&&t.generatedPassword!==e&&(t.generatedPassword=e,this.saveSiteDialogIsDisplayed||c.LegacyGlobal.bg.LPTabState.getSiteNotification({callback:this.showSaveSiteDialog.bind(this)})),[2]})})},e.prototype.showSaveSiteDialog=function(e){e.generatedPassword&&e.defaultData&&(e.dialogData.preSubmit=!0,this.hasGeneratedPasswordSinceLastAutofill=!0,c.LegacyGlobal.LPFrame.openDialog("contentScriptSite",e,{css:{top:10,right:10}}))},e.prototype.createFormProfile=function(){return{fields:[],top:window===top,url:document.location.hostname}},e=a([o.RegisterService(r.ServiceType.FormDetection)],e)}();t.FormDetectionService=u}),r("content-script/services/segment/delegated-segment.service",["require","exports","common/decorators/index","common/enums/index","content-script/legacy","content-script/services/index"],function(e,t,o,r,i,n){Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.initialize=function(){},e.prototype.send=function(e,t){i.LegacyGlobal.bg.sendLpImprove(e,t)},e.prototype.sendTypedEvent=function(e,t){return n.callBackgroundService(r.ServiceType.Segment,"sendTypedEvent",[e,t])},a([o.Visible],e.prototype,"sendTypedEvent",null),e=a([o.RegisterService(r.ServiceType.Segment,!0)],e)}();t.DelegatedSegmentService=s}),r("content-script/services/service-provider",["require","exports","common/provider.abstract","common/messaging/messaging","content-script/legacy"],function(e,t,o,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.callQueue=[],t}return c(t,e),t.prototype.getService=function(e){return this.instances[e]},t.prototype.initialize=function(){for(e.prototype.initialize.call(this);this.callQueue.length;){var t=this.callQueue.shift(),o=t.serviceType,i=t.method,n=t.args,s=t.callback;r.callMethod(this.getService(o),i,n,s)}},t.prototype.postInitialize=function(){e.prototype.postInitialize.call(this)},t.prototype.teardown=function(){e.prototype.teardown.call(this)},t.prototype.isInitialized=function(){return this.initialized},t.prototype.call=function(e,t,o,i){void 0===o&&(o=[]);try{this.isInitialized()?r.callMethod(this.getService(e),t,o,i):this.callQueue.push({serviceType:e,method:t,args:o,callback:i})}catch(e){r.handleCallbackError(e,i)}},t}(o.ProviderAbstract);function s(e,t,o,r){if("function"!=typeof r)return new Promise(function(r,n){i.LegacyGlobal.bg.LPModule.callService(e,t,o,function(e,t){e?n(e):r(t)})});i.LegacyGlobal.bg.LPModule.callService(e,t,o,r)}t.ServiceProvider=n,t.callBackgroundService=s}),r("content-script/services/tools/content-script-tools.service",["require","exports","common/decorators/index","common/enums/index"],function(e,t,o,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.unloading=!1}return e.prototype.initialize=function(){var e=this;window.addEventListener("beforeunload",function(t){!1!==t.isTrusted&&(e.unloading=!0)})},e.prototype.isUnloading=function(){return this.unloading},e.prototype.getCSS=function(e,t){return window.getComputedStyle(e).getPropertyValue(t)},e.prototype.getAttributes=function(e,t){var o=this;return t.reduce(function(t,r){return t[r]=o.getAttribute(e,r),t},{})},e.prototype.getAttribute=function(e,t){return e.hasAttribute(t)?e.getAttribute(t):void 0},e.prototype.isForm=function(e){return"FORM"===e.nodeName},e.prototype.getForm=function(e){for(;e;){if(this.isForm(e))return e;e=e.parentElement}return null},e.prototype.isClickable=function(e){if("function"==typeof document.elementFromPoint){var t=e.getBoundingClientRect();return document.elementFromPoint(t.left,t.top)===e||document.elementFromPoint(t.right,t.top)===e||document.elementFromPoint(t.left,t.bottom)===e||document.elementFromPoint(t.right,t.bottom)===e}return!0},e.prototype.isScrollableX=function(e){if(e.scrollWidth>e.clientWidth){var t=this.getCSS(e,"overflow-x");return"auto"===t||"scroll"===t}return!1},e.prototype.isScrollableY=function(e){var t;if(e.scrollHeight>e.clientHeight)switch(this.getCSS(e,"overflow-y")){case"auto":case"scroll":return!0;case"visible":return e===document.body||!e.parentElement}return!1},e.prototype.getViewableArea=function(e){for(var t={top:0,left:0,width:window.innerWidth,height:window.innerHeight},o=e.parentElement;o;)o.scrollLeft>0&&(t.left-=o.scrollLeft),o.scrollTop>0&&(t.top-=o.scrollTop),this.isScrollableX(o)&&(t.width+=o.scrollWidth-o.clientWidth),this.isScrollableY(o)&&(t.height+=o.scrollHeight-o.clientHeight),o=o.parentElement;return t.right=t.left+t.width,t.bottom=t.top+t.height,t},e.prototype.isVisible=function(e){if(!(e&&e instanceof HTMLElement))return!1;var t;if(!(e.offsetWidth||e.offsetHeight||e.getClientRects().length))return!1;var o=e.getBoundingClientRect(),r=this.getViewableArea(e);return!(o.right<r.left||o.bottom<r.top||o.left>r.right||o.top>r.bottom)},e.prototype.getElementLabel=function(e){for(var t=[function(){if(e.getAttribute("id")){var t=document.querySelector('label[for="'+e.getAttribute("id")+'"]');if(t)return t.textContent}return null},function(){for(var t=e;t;){if("LABEL"===t.tagName.toUpperCase())return t.textContent;t=t.parentElement}return null},function(){return e.getAttribute("placeholder")},function(){for(var t=e;t;){var o=t.textContent;if(o){var r=o.split("\n").map(function(e){return e.trim()}).filter(function(e){return e.length>0});if(1===r.length)return r[0];break}t=t.previousSibling||t.parentElement}}],o=0;o<t.length;++o){var r=t[o]();if(r)return r.trim()}return""},e.prototype.debounce=function(e,t,o){var r;return function(){var i=this,n=arguments,s=function(){r=null,o||e.apply(i,n)},a=o&&!r;clearTimeout(r),r=setTimeout(s,t),a&&e.apply(this,n)}},e=a([o.RegisterService(r.ServiceType.ContentScriptTools)],e)}();t.ContentScriptTools=i}),r("content-script/services/tools/dom-utils.service",["require","exports","common/decorators/index","common/enums/index"],function(e,t,o,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.prototype.initialize=function(){},e.prototype.getXPathForElement=function(e){var t=function(e,o){return e?t(e.previousElementSibling,o||e.localName)+(e.localName===o):1},o=function(e){return e&&e.nodeType===Node.ELEMENT_NODE?e.id&&document.querySelector("#"+e.id)===e?['id("'+e.id+'")']:o(e.parentNode).concat([e.localName.toLowerCase()+"["+t(e)+"]"]):[""]};return o(e).join("/")},e=a([o.RegisterService(r.ServiceType.DomUtils)],e)}();t.DomUtils=i}),r("content-script/services/web-request/delegated-web-request.service",["require","exports","common/decorators/index","common/enums/index","content-script/services/index"],function(e,t,o,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.apiSupported=!1,this.enabled=!1}return e.prototype.initialize=function(){var e=this;i.callBackgroundService(r.ServiceType.WebRequest,"isApiSupported",void 0).then(function(t){return e.apiSupported=t}),i.callBackgroundService(r.ServiceType.WebRequest,"isEnabled",void 0).then(function(t){return e.enabled=t})},e.prototype.trackFormSubmission=function(e,t,o){return i.callBackgroundService(r.ServiceType.WebRequest,"trackFormSubmission",[e,t,o])},e.prototype.isApiSupported=function(){return this.apiSupported},e.prototype.isEnabled=function(){return this.enabled},e=a([o.RegisterService(r.ServiceType.WebRequest,!0)],e)}();t.DelegatedWebRequestService=n}),r("content-script/services/index",["require","exports","content-script/services/auto-fill/auto-fill.service","content-script/services/form-detection/form-detection.service","content-script/services/segment/delegated-segment.service","content-script/services/service-provider","content-script/services/site/delegated-site.service","content-script/services/tools/content-script-tools.service","content-script/services/tools/dom-utils.service","content-script/services/web-request/delegated-web-request.service","common/services/topic/topic.service","common/services/utils/string-utils.service"],function(e,t,o,r,i,n,s,a,c,u,l,p){function d(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}Object.defineProperty(t,"__esModule",{value:!0}),d(o),d(r),d(i),d(n),d(s),d(a),d(c),d(u),d(l),d(p)}),r("content-script/repositories/auto-fill-state/delegated-auto-fill-state.repository",["require","exports","content-script/repositories/index","common/enums/index","common/decorators/index","content-script/content-script.module"],function(e,t,o,r,i,n){Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}return e.prototype.initialize=function(){this.domUtils=n.getService(r.ServiceType.DomUtils)},e.prototype.getState=function(e,t){return o.callBackgroundRepository(r.RepositoryType.AutoFillState,"getState",[null==e?n.getContentScriptInstanceInfo().tabId:e],t)},e.prototype.setState=function(e){o.callBackgroundRepository(r.RepositoryType.AutoFillState,"setState",[e])},e.prototype.deleteState=function(e){o.callBackgroundRepository(r.RepositoryType.AutoFillState,"deleteState",[e])},e.prototype.getFrameAlgorithmState=function(e,t,i,n,s){return i instanceof HTMLElement&&(i=this.domUtils.getXPathForElement(i)),o.callBackgroundRepository(r.RepositoryType.AutoFillState,"getFrameAlgorithmState",this.resolveTargetArgs(e,t).concat([i,n]),s)},e.prototype.setFrameAlgorithmState=function(e,t,i,n,s){i instanceof HTMLElement&&(i=this.domUtils.getXPathForElement(i)),o.callBackgroundRepository(r.RepositoryType.AutoFillState,"setFrameAlgorithmState",this.resolveTargetArgs(e,t).concat([i,n,s]))},e.prototype.setFrameAllowed=function(e,t,i){o.callBackgroundRepository(r.RepositoryType.AutoFillState,"setFrameAllowed",this.resolveTargetArgs(e,t).concat([i]))},e.prototype.setFrameReady=function(e,t,i){o.callBackgroundRepository(r.RepositoryType.AutoFillState,"setFrameReady",this.resolveTargetArgs(e,t).concat([i]))},e.prototype.resetFrameState=function(e,t){o.callBackgroundRepository(r.RepositoryType.AutoFillState,"resetFrameState",this.resolveTargetArgs(e,t).slice())},e.prototype.deleteFrameState=function(e,t){o.callBackgroundRepository(r.RepositoryType.AutoFillState,"deleteFrameState",this.resolveTargetArgs(e,t).slice())},e.prototype.getFillResults=function(e,t,i){return o.callBackgroundRepository(r.RepositoryType.AutoFillState,"getFillResults",this.resolveTargetArgs(e,t).slice(),i)},e.prototype.resolveTargetArgs=function(e,t){var o=n.getContentScriptInstanceInfo(),r=o.tabId,i=o.frameId;return[null==e?r:e,null==t?i:t]},e=a([i.RegisterRepository(r.RepositoryType.AutoFillState,!0)],e)}();t.DelegatedAutoFillStateRepository=s}),r("content-script/repositories/feature/delegated-feature.repository",["require","exports","common/decorators/index","common/enums/index","content-script/legacy"],function(e,t,o,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.initialize=function(){},e.prototype.get=function(e){var t=Array.from(arguments);return new Promise(function(e,o){i.LegacyGlobal.bg.LPModule.callRepository(r.RepositoryType.Feature,"get",t,function(t,r){t?o(t):e(r)})})},e.prototype.set=function(e,t){i.LegacyGlobal.bg.LPModule.callRepository(r.RepositoryType.Feature,"set",Array.from(arguments))},e=a([o.RegisterRepository(r.RepositoryType.Feature,!0)],e)}();t.DelegatedFeatureRepository=n}),r("content-script/repositories/repository-provider",["require","exports","common/provider.abstract","content-script/legacy"],function(e,t,o,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.queue=[],t}return c(t,e),t.prototype.getRepository=function(e,t){var o,r;if(this.initialized)(r=this.instances[e])||(o="Cannot find repository [ "+e+" ]");else{if(t)return void this.queue.push({repositoryType:e,callback:t});o="Repository provider is undefined."}if(o)throw new Error(o);if(!t)return r;t(null,r)},t.prototype.initialize=function(){for(e.prototype.initialize.call(this);this.queue.length;)try{var t=this.queue.shift(),o=t.repositoryType,r=t.callback;this.getRepository(o,r)}catch(e){console.error(e)}},t.prototype.postInitialize=function(){e.prototype.postInitialize.call(this)},t.prototype.teardown=function(){e.prototype.teardown.call(this)},t}(o.ProviderAbstract);function n(e,t,o,i){if("function"!=typeof i)return new Promise(function(i,n){r.LegacyGlobal.bg.LPModule.callRepository(e,t,o,function(e,t){e?n(e):i(t)})});r.LegacyGlobal.bg.LPModule.callRepository(e,t,o,i)}t.RepositoryProvider=i,t.callBackgroundRepository=n}),r("content-script/repositories/index",["require","exports","content-script/repositories/auto-fill-state/delegated-auto-fill-state.repository","content-script/repositories/feature/delegated-feature.repository","content-script/repositories/repository-provider"],function(e,t,o,r,i){function n(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}Object.defineProperty(t,"__esModule",{value:!0}),n(o),n(r),n(i)}),r("content-script/views/basic-auth/basic-auth.view",["require","exports","content-script/legacy"],function(e,t,o){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;o.LegacyGlobal.bg.basicAuth.hasFeature(function(t){t&&o.LegacyGlobal.bg.basicAuth.isBasicAuth(function(t,o){return e.init(t,o)})})}return e.prototype.init=function(e,t){var r=this;e&&(this.backgroundInterface=o.LegacyGlobal.bg,this.loadContent(function(){r.initContent(t)}))},e.prototype.loadContent=function(e){var t=this;$.get(chrome.runtime.getURL("/content-script/views/basic-auth/basic-auth.html"),function(o){var r=t.replaceRelativePaths(o);$(document.body).empty().append(r),e()})},e.prototype.initContent=function(e){var t;$("#ba_username").focus(),e||$("#wronguserpass").hide(),document.title="Lastpass basic auth login",$("#title").text(location.host),"http:"===location.protocol?$("#secureWarning").show():$("#secureWarning").hide(),this.subscribeEvents(),this.openPopupNotification(),this.backgroundInterface.sendLpImprove("basicauth::triggered")},e.prototype.subscribeEvents=function(){var e=this;$("#lp-login-btn").click(function(){$(".js-notification").toggle("notification-visible"),e.doLogin()}),$("#password").keypress(function(t){13===t.which&&e.doLogin()}),$("#lp-cancel-btn").click(function(){e.cancelBasicAuth(),e.backgroundInterface.sendLpImprove("basicauth::cancel")}),$(".notification__close__button").click(function(){$(".notification__body").removeClass("slide-in").addClass("slide-out"),e.backgroundInterface.basicAuth.closeNotification()})},e.prototype.doLogin=function(){var e=$("#ba_username").val(),t=$("#ba_password").val();this.backgroundInterface.sendLpImprove("basicauth::login"),this.backgroundInterface.basicAuth.setAuthCredential(e,t,function(){return location.reload()})},e.prototype.cancelBasicAuth=function(){this.backgroundInterface.basicAuth.cancelBasicAuth(),$("#login-body").hide(),location.reload()},e.prototype.replaceRelativePaths=function(e){var t=chrome.runtime.getURL("");return e.replace(new RegExp("{extensionUrl}","g"),t)},e.prototype.openPopupNotification=function(){this.backgroundInterface.basicAuth.isNotificationClosed(function(e){e?$(".notification__body").hide():$(".notification__body").addClass("slide-in")})},e}();t.BasicAuthView=r}),r("content-script/views/index",["require","exports","content-script/views/basic-auth/basic-auth.view"],function(e,t,o){function r(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}Object.defineProperty(t,"__esModule",{value:!0}),r(o)}),r("content-script/content-script.module",["require","exports","common/enums/index","content-script/repositories/index","content-script/services/index","content-script/views/index","common/module.abstract","common/decorators/index","content-script/legacy"],function(e,t,o,r,i,a,u,l,p){Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(){var t=e.call(this)||this;return t.requestFrameworkInitialized=new Promise(function(e){p.LegacyGlobal.Topics.get(o.TopicType.RequestFrameworkInitialized).subscribe(function(t){return e(t)})}),window.addEventListener("beforeunload",function(){t.serviceProvider&&t.serviceProvider.teardown(),t.repositoryProvider&&t.repositoryProvider.teardown()}),t}return c(t,e),t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.getContentScriptInstanceInfo=function(){return this.csInfo},t.prototype.initialize=function(){return n(this,void 0,void 0,function(){var e,t,o,n,a;return s(this,function(s){switch(s.label){case 0:return this.serviceProvider=new i.ServiceProvider(l.getServiceRegistry()),this.repositoryProvider=new r.RepositoryProvider(l.getRepositoryRegistry()),[4,this.requestFrameworkInitialized];case 1:return e=s.sent(),t=e.tabID,o=e.frameID,n=e.topFrameID,a=e.request,this.csInfo={tabId:t,frameId:o,topFrameId:n,childFrameCount:a.childFrameCount,isTop:a.top,url:a.url},this.repositoryProvider.initialize(),this.serviceProvider.initialize(),[2]}})})},t.prototype.postInitialize=function(){return n(this,void 0,void 0,function(){return s(this,function(e){return this.repositoryProvider.postInitialize(),this.serviceProvider.postInitialize(),self.basicAuth=new a.BasicAuthView,[2]})})},t.prototype.getServiceProvider=function(){return this.serviceProvider},t.prototype.getRepositoryProvider=function(){return this.repositoryProvider},t.prototype.getService=function(e){if(!this.serviceProvider.isInitialized)throw new Error("Service provider is undefined.");var t=this.serviceProvider.getService(e);if(!t)throw new Error("Cannot find service [ "+e+" ]");return t},t.prototype.getRepository=function(e){var t=this.repositoryProvider.getRepository(e);if(!t)throw new Error("Cannot find repository [ "+e+" ]");return t},t.prototype.isInitialized=function(t){e.prototype.isInitialized.call(this,t)},t.instance=null,t}(u.ModuleAbstract);function f(){return d.getInstance().getContentScriptInstanceInfo()}function m(e){return d.getInstance().getService(e)}function y(e){return d.getInstance().getRepository(e)}function v(e){return d.getInstance().isInitialized(e)}function g(e,t,o,r){void 0===o&&(o=[]),d.getInstance().getServiceProvider().call(e,t,o,r)}t.getContentScriptInstanceInfo=f,t.getService=m,t.getRepository=y,t.isInitialized=v,t.callService=g,t.default=d.getInstance()}),e.LPModule=o("content-script/content-script.module")}).call(this);
//# sourceMappingURL=sourcemaps/modules-contentscript.js.map
