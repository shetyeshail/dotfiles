var lpResizeEvent=function(){"use strict";var e,t;function n(){e||(e=setTimeout(function(){e=null,i()},66))}function i(){t&&t()}function o(e){t=e,window.addEventListener("resize",n)}function l(){t=null,window.removeEventListener("resize",n)}return{attachWindowResizeEvent:o,detachWindowResizeEvent:l}}(),LPInfieldFrame=function(){"use strict";var e,t="contentScriptPopup.html",n,i,o;function l(e,t){var n;return function(){var i=this,o=arguments;clearTimeout(n),n=setTimeout(function(){n=null,e.apply(i,o)},t)}}function r(e){(o=o||l(f,100))(e)}function f(o){if(i)i=!1;else{if(o.iframe&&!o.fieldEl)try{o.fieldEl=$(o.iframe).contents().find("#"+o.id)[0]}catch(e){}if(o){if(e){if(n.id===o.id)return;a("away")}!0===bg.get("LPContentScriptFeatures").better_generate_password_enabled&&(t="betterContentScriptPopup.html"),o.url=t,n=o,(e=LPFrame.openFrame({url:t,interfaceDefinition:Interfaces.InfieldPopupInterface})).onClose(function(){e=null}),u(),v(),lpResizeEvent.attachWindowResizeEvent(v),window.addEventListener("click",s,!0),bg.sendLpImprove("newinfieldopen",{source:"formv2",option:o.eventType})}}}function s(e){return(!n||e.target.id!==n.id&&e.target!==n.fieldEl)&&(a("away"),!0)}function a(t){e&&(t&&(i="action"==t,bg.sendLpImprove("newinfieldclose",{source:"formv2",option:t})),window.removeEventListener("click",s),lpResizeEvent.detachWindowResizeEvent(),e&&(e.close(),Topics.publish(Topics.INFIELD_NOTIFICATION_CLOSED)),e=null,n=null)}function c(e,t){var n={};return e&&(n.height=e),t&&(n.width=t),n}function d(e){var t=375;!0===bg.get("LPContentScriptFeatures").better_generate_password_enabled&&(t=310);var n={top:0,left:0};if(e){var i={top:0,left:0};e.iframe&&(i=e.iframe.getBoundingClientRect());var o={bottom:parseInt(e.posy),left:parseInt(e.posx),width:e.width};if(e.fieldEl&&e.fieldEl.getBoundingClientRect?o=e.fieldEl.getBoundingClientRect():e.fieldBox&&(o=e.fieldBox),n.top=window.pageYOffset+i.top+o.bottom,n.left=window.pageXOffset+i.left+o.left+o.width,g_issafari_appext){var l=LPContentScriptTools.getZoom();n.left-=(t-15)/l+15}else n.left-=t;n.left<=0&&(n.left=window.pageXOffset+i.left+o.left-10)}return n}function p(t){e&&e.getInterface().lpInfield.setArrowPosition({position:t})}function u(){e&&e.css({display:"block",position:"absolute",height:"0px"})}function w(t,n){e&&e.css(c(t,n))}function v(t){var i=null;if(n.fieldEl&&!LPContentScriptTools.isVisible(n.fieldEl))a();else if(e){var o;(i=d(n)).infieldOffset=360,!0===bg.get("LPContentScriptFeatures").better_generate_password_enabled&&(i.infieldOffset=295),(Math.abs(parseInt(n.posx)-i.left)>10||i.left>i.infieldOffset&&i.left<window.outerWidth)&&p(i.left<=0?25:i.infieldOffset),e.css(i),t&&"function"==typeof t&&t(i),csTop.Topics.publish(Topics.INFIELD_FRAME_POSITION_CHANGED,i)}}function m(e,t,n){(e==punycode.URLToASCII(document.location.href)||has_same_tld(e,document.location.href))&&populategeneratedpassword(e,t,n)}return{close:a,show:u,openFrame:r,resizeFrame:w,positionFrame:v,fillGeneratedPassword:m}}();function LP_keypress_handler(e){"use strict";27!=e.keyCode?9!=e.keyCode||csTop.LPInfieldFrame.close("away"):csTop.LPInfieldFrame.close("close")}
//# sourceMappingURL=sourcemaps/contentScriptInfieldFrame.js.map
