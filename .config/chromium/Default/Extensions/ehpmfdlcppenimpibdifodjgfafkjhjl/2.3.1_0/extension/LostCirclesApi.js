function trackButtonClick(e){_gaq.push(["_trackEvent",e.target.id,"clicked"])}function showDownloadBlob(e,t){var n=document.createElement("a");document.body.appendChild(n),n.style="display: none",blob=new Blob([e],{type:"octet/stream"}),url=window.URL.createObjectURL(blob),n.href=url,n.download=t,n.click()}function downloadGraphml(e){getJsonGraph(function(e){var t=convertToGraphmlString(e),n=e.userName+".graphml";showDownloadBlob(t,n)},e)}function convertToGraphmlString(e){var t=document.implementation.createDocument("http://graphml.graphdrawing.org/xmlns","graphml"),n=t.documentElement;n.setAttribute("xmlns","http://graphml.graphdrawing.org/xmlns"),n.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),n.setAttribute("xsi:schemaLocation","http://graphml.graphdrawing.org/xmlns http://graphml.graphdrawing.org/xmlns/1.0/graphml.xsd");var r=document.createComment("Created with Lost Circles Chrome extension, see http://lostcircles.com or https://chrome.google.com/webstore/detail/lost-circles-facebook-gra/ehpmfdlcppenimpibdifodjgfafkjhjl");n.appendChild(r);var a=e.nodes,o=e.links,i=a[1],c={},d=0;for(var l in i)if(i.hasOwnProperty(l)){var s=document.createElementNS("","key");s.setAttribute("id","d".concat(d)),s.setAttribute("for","node"),s.setAttribute("attr.name",l),s.setAttribute("attr.type","string");var u=document.createElementNS("","default");u.appendChild(document.createTextNode("")),s.appendChild(u),n.appendChild(s),c[l]="d".concat(d),d+=1}var p=o[0],m={};for(var l in p)if(p.hasOwnProperty(l)&&"source"!==l&&"target"!==l){var s=document.createElementNS("","key");s.setAttribute("id","d".concat(d)),s.setAttribute("for","edge"),s.setAttribute("attr.name",l),s.setAttribute("attr.type","string");var u=dedocument.createElementNS("","default");u.appendChild(document.createTextNode("")),s.appendChild(u),n.appendChild(s),m[l]="d".concat(d),d+=1}var h=document.createElementNS("","graph");h.setAttribute("id","G"),h.setAttribute("edgedefault","undirected"),n.appendChild(h);for(var g=0;g<a.length;g++){var f=a[g],b=document.createElementNS("","node");b.setAttribute("id","n".concat(g));for(var l in f)if(f.hasOwnProperty(l)){var v=document.createElementNS("","data");v.setAttribute("key",c[l]);var w=document.createTextNode(f[l]);v.appendChild(w),b.appendChild(v)}h.appendChild(b)}for(var g=0;g<o.length;g++){var k=o[g],b=document.createElementNS("","edge");b.setAttribute("id","e".concat(g)),b.setAttribute("source","n".concat(k.source)),b.setAttribute("target","n".concat(k.target));for(var l in k)if(k.hasOwnProperty(l)&&"source"!==l&&"target"!==l){var v=document.createElementNS("","data");v.setAttribute("key",m[l]);var w=document.createTextNode(k[l]);v.appendChild(w),b.appendChild(v)}h.appendChild(b)}var y=(new XMLSerializer).serializeToString(t.documentElement);return y}function getJsonGraph(e,t){chrome.runtime.sendMessage({type:"getNetwork"},function(n){if("undefined"!=typeof t){var r=JSON.stringify(n,t),a=JSON.parse(r);return void e(a)}"undefined"!=typeof e&&e(n)})}function downloadJsonGraph(e){getJsonGraph(function(e){var t=e.userName+".json",n=JSON.stringify(e);showDownloadBlob(n,t)},e)}function hashCode(e){var t=0;if(0==e.length)return t;for(i=0;i<e.length;i++)char=e.charCodeAt(i),t=(t<<5)-t+char,t&=t;return t}function getBackbone(){if("undefined"!=typeof network){for(var e=0;e<network.nodes.length-1;e++)network.nodes[e].name=e,network.nodes[e].userName=e,network.nodes[e].id=e,network.nodes[e].dataUrl="";$.ajax({type:"POST",timeout:25e3,url:"https://lostcircles.com:8443/backbone",data:JSON.stringify(network),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){parseBackbone(e)},failure:function(e){console.log(e),alert("could not retrieve backbone")}})}}function parseBackbone(e){for(var t=globalForce.links(),n=0;n<e.links.length;n++)t[n].additionalProperties=e.links[n].additionalProperties;var r=e.links.filter(function(e){return e.additionalProperties.backbone});r=JSON.parse(JSON.stringify(r)),globalForce.links(r).start();var a=d3.select("div#mainSVG");a.selectAll(".link").attr("display",function(e){return e.additionalProperties.backbone?"inline":"none"})}var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-73065336-1"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElementNS("","script");e.type="text/javascript",e.async=!0,e.src="https://ssl.google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),document.addEventListener("DOMContentLoaded",function(){for(var e=document.querySelectorAll("a"),t=0;t<e.length;t++)e[t].addEventListener("click",trackButtonClick)});var lc={openInNewTab:function(e){var t=window.open(e,"_blank");t.focus()},clearData:function(){chrome.runtime.sendMessage({subject:"deleteData"},function(e){alert("Cleared data.")})}},jsonReplacer={replaceNull:function(e,t){return null==t?"":t},removeDataUrl:function(e,t){return"dataUrl"===e?"":t}};